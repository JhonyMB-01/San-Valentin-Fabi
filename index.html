<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Para Ti üíñ</title>

<style>
:root { --rosa:#ff3366; }

* { box-sizing:border-box; }

body {
  margin: 0;
  min-height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
  overflow-x: hidden;
  overflow-y: auto;
  font-family: 'Georgia', serif;
  background: #0d0d1a;
  color: white;
  padding: 1rem;
}

/* Fondo */
#fondo {
  position: fixed;
  inset: 0;
  background: linear-gradient(120deg,#0d0d1a,#1a1a2e,#0d0d1a);
  z-index:-2;
}
.aurora {
  position:absolute;
  width:300%;
  height:200%;
  top:-50%;
  left:-100%;
  background:radial-gradient(circle,rgba(255,100,180,.25),transparent 70%);
  filter:blur(60px);
  animation:auroraMove 18s infinite alternate;
}
@keyframes auroraMove { to{transform:rotate(25deg) translate(120px,60px);} }

/* Estrellas */
.star{
  position:absolute;
  width:2px;height:2px;
  background:white;border-radius:50%;
  opacity:0;animation:twinkle 3s infinite;
}
@keyframes twinkle{50%{opacity:1;}}

/* Card */
.card{
  background:rgba(255,255,255,0.18);
  padding:clamp(1.5rem,4vw,3rem);
  border-radius:24px;
  max-width:560px;width:100%;
  max-height:90vh;overflow-y:auto;
  backdrop-filter:blur(14px);
  box-shadow:0 25px 60px rgba(0,0,0,.45);
  text-align:center;
}

.card.vibrate{animation:vibrar .25s infinite alternate;}
@keyframes vibrar{
  from{transform:translate(1px,-1px);}
  to{transform:translate(-1px,1px);}
}

h1{font-size:clamp(1.5rem,4vw,2.2rem);}
p{font-size:clamp(1rem,2.5vw,1.1rem);}

button{
  margin-top:1rem;
  padding:.9rem 1.8rem;
  border:none;border-radius:30px;
  background:var(--rosa);color:white;
  font-size:clamp(.95rem,2.5vw,1rem);
  cursor:pointer;width:100%;max-width:260px;
}

#carta{text-align:left;margin-top:1.2rem;line-height:1.6;}
#carta strong{color:#fff6c9;}

#pregunta,#respuestas{
  margin-top:1.2rem;
  opacity:0;visibility:hidden;
  transition:opacity 1s ease;
}
.mostrar{opacity:1!important;visibility:visible!important;}

@keyframes fadeIn{
  from{opacity:0;transform:translateY(10px);}
  to{opacity:1;transform:translateY(0);}
}

/* Corazones */
.heart {
  position: absolute;
  animation: subir 6s linear forwards;
  opacity: 0;
}
@keyframes subir {
  0% { transform: translateY(0); opacity: 0; }
  20% { opacity: 1; }
  100% { transform: translateY(-110vh); opacity: 0; }
}

/* Canvas */
canvas{
  position:fixed;
  inset:0;
  pointer-events:none;
  z-index:999;
}
</style>
</head>

<body>

<div id="fondo"><div class="aurora"></div></div>
<audio id="musica" loop>
  <source src="https://www.dropbox.com/scl/fi/q9yslidz4h27xqndg335t/She-is-Clazziquai.mp3?rlkey=5cuk7pcxhk1ld42vaqqo1jn4z&st=r5bmkd33&raw=1" type="audio/mpeg">
</audio>

<canvas id="confetti"></canvas>
<canvas id="fireworks"></canvas>

<div class="card" id="modal">
  <h1>Para Ti Mi Poshi üíï</h1>
  <p>Hay algo que quiero decirte‚Ä¶</p>

  <button onclick="iniciar()">√Åbreme üíå</button>

  <div id="carta"></div>

  <div id="pregunta">¬øQuieres seguir siendo mi San Valent√≠n? üíñ</div>
  <div id="respuestas">
    <button onclick="respuesta('S√≠ üíï')">S√≠ üíï</button>
    <button onclick="respuesta('Obvio üòå')">Obvio üòå</button>
  </div>
</div>

<script>
/* CARTA */
const bloques=[
"<strong>Mi poshi,</strong> hoy quiero detener el tiempo para recordarte lo especial que eres para m√≠.",
"Han pasado <strong>4 a√±os desde que nos casamos</strong>, y cada d√≠a confirmo que elegirte fue la mejor decisi√≥n de mi vida.",
"Hemos vivido risas, retos y aprendizajes, pero siempre juntos, creciendo y apoy√°ndonos.",
"Gracias por ser mi hogar, mi compa√±era y el amor de mi vida.",
"Hoy y siempre, <strong>te vuelvo a elegir.</strong> üíçüíñ"
];

let index = 0;
const carta = document.getElementById("carta");

/* Estrellas */
const estrellas = window.innerWidth < 600 ? 80 : 160;
for(let i=0;i<estrellas;i++){
  const s=document.createElement("div");
  s.className="star";
  s.style.top=Math.random()*100+"%";
  s.style.left=Math.random()*100+"%";
  s.style.animationDuration=(Math.random()*3+2)+"s";
  document.body.appendChild(s);
}

/* CORAZONES */
let intervaloCorazones;
function crearCorazon(){
  const h=document.createElement("div");
  h.className="heart";
  h.innerHTML=["‚ù§Ô∏è","üíñ","üíï","üíò"][Math.floor(Math.random()*4)];
  h.style.left=Math.random()*100+"vw";
  h.style.fontSize=(Math.random()*22+16)+"px";
  document.body.appendChild(h);
  setTimeout(()=>h.remove(), 6000);
}

function iniciarCorazones(){
  intervaloCorazones = setInterval(crearCorazon, 700);
}

/* VIBRACI√ìN */
function vibrar(){
  if(navigator.vibrate) navigator.vibrate(200);
}

/* CONFETI */
const confettiCanvas = document.getElementById("confetti");
const cctx = confettiCanvas.getContext("2d");
confettiCanvas.width = innerWidth;
confettiCanvas.height = innerHeight;
let confettis = [];
let confettiActivo = false;
const maxConfetti = window.innerWidth < 600 ? 80 : 150;

function resizeConfetti(){
  confettiCanvas.width = innerWidth;
  confettiCanvas.height = innerHeight;
}
window.addEventListener("resize", resizeConfetti);

function crearConfetti(){
  if(!confettiActivo) return;
  confettis.push({
    x: Math.random() * confettiCanvas.width,
    y: -10,
    r: Math.random() * 4 + 3,
    d: Math.random() * 1 + 1,
    c: ["#ff3366","#fff","#ffcc00","#ff99cc"][Math.floor(Math.random()*4)]
  });
}

function animarConfetti(){
  cctx.clearRect(0,0,confettiCanvas.width,confettiCanvas.height);
  if(confettiActivo && confettis.length < maxConfetti) crearConfetti();

  confettis.forEach((p, i) => {
    cctx.fillStyle = p.c;
    cctx.beginPath();
    cctx.arc(p.x, p.y, p.r, 0, Math.PI*2);
    cctx.fill();
    p.y += p.d;
    if(p.y > confettiCanvas.height) confettis.splice(i,1);
  });

  requestAnimationFrame(animarConfetti);
}
animarConfetti();

/* FUEGOS ARTIFICIALES */
const fwCanvas = document.getElementById("fireworks");
const fctx = fwCanvas.getContext("2d");
fwCanvas.width = innerWidth;
fwCanvas.height = innerHeight;
let sparks = [];
let fuegosActivos = false;

function resizeFireworks(){
  fwCanvas.width = innerWidth;
  fwCanvas.height = innerHeight;
}
window.addEventListener("resize", resizeFireworks);

function crearFuego(){
  if(!fuegosActivos) return;
  const x = Math.random() * fwCanvas.width;
  const y = Math.random() * fwCanvas.height / 2;
  for(let i=0; i<25; i++){
    sparks.push({
      x, y,
      vx: (Math.random()-0.5)*4,
      vy: (Math.random()-0.5)*4,
      life: 50
    });
  }
}

setInterval(crearFuego, 1200);

function animarFuegos(){
  fctx.clearRect(0,0,fwCanvas.width, fwCanvas.height);
  sparks.forEach((s, i) => {
    fctx.fillStyle = "rgba(255,200,200,.8)";
    fctx.fillRect(s.x, s.y, 2, 2);
    s.x += s.vx;
    s.y += s.vy;
    s.life--;
    if(s.life <= 0) sparks.splice(i,1);
  });
  requestAnimationFrame(animarFuegos);
}
animarFuegos();

/* ESCRIBIR CARTA */
function iniciar(){
    const audio=document.getElementById("musica");
    audio.volume=0.8;
    audio.play().catch(()=>{});
  document.getElementById("modal").classList.add("vibrate");
  escribir();
  iniciarCorazones();
}

function escribir(){
  if(index < bloques.length){
    carta.innerHTML += bloques[index] + "<br><br>";
    index++;
    setTimeout(escribir, 600);
  } else {
    pregunta.classList.add("mostrar");
    respuestas.classList.add("mostrar");
  }
}

/* RESPUESTA */
function respuesta(valor){
  vibrar();
  clearInterval(intervaloCorazones);

  // ACTIVA CONFETI + FUEGOS SOLO AL ACEPTAR
  confettiActivo = true;
  fuegosActivos = true;

  respuestas.innerHTML = `
    <p style="font-size:1.4rem;animation:fadeIn 1s;">
      Me encanta que hayas dicho <strong>${valor}</strong> üíñ‚ú®<br>
      Gracias por estos 4 a√±os incre√≠bles üíç
    </p>
  `;
}
</script>

</body>
</html>
